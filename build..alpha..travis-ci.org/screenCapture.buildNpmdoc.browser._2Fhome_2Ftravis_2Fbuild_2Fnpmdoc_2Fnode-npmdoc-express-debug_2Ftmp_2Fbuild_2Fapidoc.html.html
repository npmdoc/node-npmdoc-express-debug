<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/devoidfury/express-debug">express-debug (v1.1.1)</a>
</h1>
<h4>debug toolbar middleware for developing applications in expressjs</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.express-debug">module express-debug</a><ol>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">express-debug.</span>request</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">express-debug.</span>response</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">express-debug.</span>utils</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.express-debug.request">module express-debug.request</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.express-debug.request.add">
            function <span class="apidocSignatureSpan">express-debug.request.</span>add
            <span class="apidocSignatureSpan">(req, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.express-debug.request.clear">
            function <span class="apidocSignatureSpan">express-debug.request.</span>clear
            <span class="apidocSignatureSpan">(index)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.express-debug.request.list">
            function <span class="apidocSignatureSpan">express-debug.request.</span>list
            <span class="apidocSignatureSpan">(index)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.express-debug.request.rawBody">
            function <span class="apidocSignatureSpan">express-debug.request.</span>rawBody
            <span class="apidocSignatureSpan">(req, res, next)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.express-debug.response">module express-debug.response</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.express-debug.response.init">
            function <span class="apidocSignatureSpan">express-debug.response.</span>init
            <span class="apidocSignatureSpan">(app, settings)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.express-debug.utils">module express-debug.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.express-debug.utils.flatten">
            function <span class="apidocSignatureSpan">express-debug.utils.</span>flatten
            <span class="apidocSignatureSpan">(arr, out)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.express-debug.utils.get_ms_from_ns">
            function <span class="apidocSignatureSpan">express-debug.utils.</span>get_ms_from_ns
            <span class="apidocSignatureSpan">(ns)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.express-debug.utils.inject_toolbar">
            function <span class="apidocSignatureSpan">express-debug.utils.</span>inject_toolbar
            <span class="apidocSignatureSpan">(str, toolbar)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.express-debug" id="apidoc.module.express-debug">module express-debug</a></h1>







</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.express-debug.request" id="apidoc.module.express-debug.request">module express-debug.request</a></h1>


    <h2>
        <a href="#apidoc.element.express-debug.request.add" id="apidoc.element.express-debug.request.add">
        function <span class="apidocSignatureSpan">express-debug.request.</span>add
        <span class="apidocSignatureSpan">(req, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">add = function (req, args) {
    panels.finalize(req);

    if (panels.use_requests) {
        var data = {
            body:        Object.keys(req.body).length ? req.body : req.rawBody,
            query:       Object.keys(req.query).length ? req.query : undefined,
            method:      req.method,
            path:        req.path,
            locals:      req.res.locals,
            send_args:   args,
            req_headers: req.headers,
            res_headers: req.res._headers,
            panels:      req.EDT
        };
        // break any references
        requests.push(JSON.parse(JSON.stringify(data)));
        data = null;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        // inject toolbar callback into render callback
        res._EDT_orig_render.call(res, view, options, toolbar_callback);
    }
};

var send = function() {
    if (this.EDT_rendered !== true) {
        request.<span class="apidocCodeKeywordSpan">add</span>(this.req, arguments);
    }
    this._EDT_orig_send.apply(this, arguments);
};

response.patch = function(res) {
    res._EDT_orig_render = res.render;
    res.render = render;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.express-debug.request.clear" id="apidoc.element.express-debug.request.clear">
        function <span class="apidocSignatureSpan">express-debug.request.</span>clear
        <span class="apidocSignatureSpan">(index)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clear = function (index) {
    requests = requests.slice(index, requests.length)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.express-debug.request.list" id="apidoc.element.express-debug.request.list">
        function <span class="apidocSignatureSpan">express-debug.request.</span>list
        <span class="apidocSignatureSpan">(index)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">list = function (index) {
    index = index || 0;

    return requests.slice(index, requests.length);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.express-debug.request.rawBody" id="apidoc.element.express-debug.request.rawBody">
        function <span class="apidocSignatureSpan">express-debug.request.</span>rawBody
        <span class="apidocSignatureSpan">(req, res, next)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rawBody = function (req, res, next) {
    var data = '';
    req.setEncoding('utf8');
    req.on('data', function (chunk) { data += chunk; });
    req.on('end', function () { req.rawBody = data || undefined; });
    next();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.express-debug.response" id="apidoc.module.express-debug.response">module express-debug.response</a></h1>


    <h2>
        <a href="#apidoc.element.express-debug.response.init" id="apidoc.element.express-debug.response.init">
        function <span class="apidocSignatureSpan">express-debug.response.</span>init
        <span class="apidocSignatureSpan">(app, settings)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function (app, settings) {
    var theme = null;

    // user-supplied css
    if (settings.theme) {
        try {
            theme = fs.readFileSync(settings.theme, 'utf-8');
        } catch (e) {
            console.error('EDT: error loading css file at ' + settings.theme);
            console.error('please check that the path is correct. Err: ', e);
        }
    }

    // replaces res.render and injects express-debug toolbar
    var render = function (view, options, fn) {
        options = options || {};

        var res = this,
            req = this.req,
            app = this.app,
            accept = req.headers.accept || '';


        var finalize = function (err, str) {
            // keep existing callback if one was passed
            if (typeof fn === 'function') {
                fn(err, str);
            } else if (err) {
                req.next(err);
            } else {
                res.send(str);
            }
        };

        panels.finalize(req);

        // support callback function as second arg
        if (typeof options === 'function') {
            fn = options;
            options = {};
        }

        // merge res.locals
        options._locals = res.locals;

        var render_toolbar = function (str, callback) {
            var standalone = settings.path === req.path;
            var opts = {
                EDTsettings: settings,
                theme:       theme,
                req:         req,
                standalone:  standalone,
                extra_attrs: settings.extra_attrs,
                panels:      panels.render({
                    locals: options,
                    app:    app,
                    res:    res,
                    req:    req,
                    view:   view
                }, settings, standalone)
            };

            jade.renderFile(template, opts, function (err, toolbar) {
                callback(err, err ? undefined : utils.inject_toolbar(str, toolbar));
            });
        };

        var toolbar_callback = function (err, str) {
            panels.post_render(req);

            if (err) {
                console.log(err);
                req.next(err);

                // skip if this client req isn't expecting html or is ajax
            } else if (accept.indexOf('html') === -1 ||  req.xhr) {
                res.send(str);

            } else if (res.EDT_rendered) {
                // if callback method was used, more than one template may be rendered.
                // in this care, do not render another copy
                // TODO: see if we can catch this on the last render, and attach it in .send instead
                finalize(err, str);

            } else {
                res.EDT_rendered = true;
                render_toolbar(str, finalize);
            }
        };

        panels.pre_render(req);
        if (req.path.indexOf(settings.path) === 0) {
            // standalone mode
            jade.renderFile(fullpage, function (err, str) {
                toolbar_callback(err, str);
            });

        } else {
            // inject toolbar callback into render callback
            res._EDT_orig_render.call(res, view, options, toolbar_callback);
        }
    };

    var send = function() {
        if (this.EDT_rendered !== true) {
            request.add(this.req, arguments);
        }
        this._EDT_orig_send.apply(this, arguments);
    };

    response.patch = function(res) {
        res._EDT_orig_render = res.render;
        res.render = render;
        res._EDT_orig_send = res.send;
        res.send = send;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.express-debug.utils" id="apidoc.module.express-debug.utils">module express-debug.utils</a></h1>


    <h2>
        <a href="#apidoc.element.express-debug.utils.flatten" id="apidoc.element.express-debug.utils.flatten">
        function <span class="apidocSignatureSpan">express-debug.utils.</span>flatten
        <span class="apidocSignatureSpan">(arr, out)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">flatten = function (arr, out) {
    out = out || [];

    if (arr instanceof Array) {
        arr.forEach(function (item, i) {
            if (item instanceof Array) {
                utils.flatten(item, out);
            } else {
                item.EDT_parent = item.EDT_parent || arr;
                item.EDT_index = i;
                out.push(item)
            }
        });
    }

    return out;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    // flatten a multidimensional array, with references
    flatten: function(arr, out) {
out = out || [];

if (arr instanceof Array) {
    arr.forEach(function (item, i) {
        if (item instanceof Array) {
            utils.<span class="apidocCodeKeywordSpan">flatten</span>(item, out);
        } else {
            item.EDT_parent = item.EDT_parent || arr;
            item.EDT_index = i;
            out.push(item)
        }
    });
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.express-debug.utils.get_ms_from_ns" id="apidoc.element.express-debug.utils.get_ms_from_ns">
        function <span class="apidocSignatureSpan">express-debug.utils.</span>get_ms_from_ns
        <span class="apidocSignatureSpan">(ns)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get_ms_from_ns = function (ns) {
    return (ns / 10000 | 0) / 100;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.express-debug.utils.inject_toolbar" id="apidoc.element.express-debug.utils.inject_toolbar">
        function <span class="apidocSignatureSpan">express-debug.utils.</span>inject_toolbar
        <span class="apidocSignatureSpan">(str, toolbar)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inject_toolbar = function (str, toolbar) {
    var location = str.lastIndexOf('&lt;/body');

    if (location === -1) {
        location = str.lastIndexOf('&lt;/html');
    }

    if (location === -1) {
        str += toolbar;
    } else {
        str = str.substring(0, location) + toolbar + str.substring(location);
    }
    return str;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        res:    res,
        req:    req,
        view:   view
    }, settings, standalone)
};

jade.renderFile(template, opts, function (err, toolbar) {
    callback(err, err ? undefined : utils.<span class="apidocCodeKeywordSpan">inject_toolbar</span>(str, toolbar));
});
        };

        var toolbar_callback = function (err, str) {
panels.post_render(req);

if (err) {
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>